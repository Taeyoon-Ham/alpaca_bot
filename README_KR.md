# Regime-Aware Core–Overlay 포트폴리오
## SPY Core + 조건부 Overlay (Alpaca Paper Trading)

본 저장소는 **전략 리서치와 실제 실행(Execution)을 연결하는 실행형 프로토타입**입니다.

핵심 목표는 단순합니다.
- 시장 베타는 **SPY 코어 포지션으로 유지**
- 시장 구조가 유리할 때만 **소규모 알파 오버레이를 조건부로 추가**
- 실제 계좌에서 반복 실행 가능한 **리스크 가드와 운영 안전장치**를 구현

본 프로젝트는 다음 역량을 증명하기 위해 설계되었습니다.
1) **퀀트 리서치**: 신호 설계, 게이팅, 성과 평가  
2) **실행 엔지니어링**: 목표 비중 리밸런싱, 주문 생성, 운영 리스크 관리

> 본 프로젝트는 **Alpaca Paper Trading** 기반이며, 실거래 자금은 사용하지 않습니다.

---

## 문제의식 (왜 이 전략을 만들었는가)

SPY를 장기적으로 이기는 것은 매우 어렵습니다.  
많은 알파 전략은 백테스트에서는 좋아 보이지만, 실제 운용에서는 다음 이유로 실패합니다.

- 시장 국면 변화에 따른 신호 붕괴
- 크라우딩으로 인한 분산 효과 상실
- 과도한 회전율로 인한 거래비용 누적
- 실행 로직 부재로 인한 운영 사고

따라서 본 전략은 다음 구조를 채택합니다.

- **Core:** SPY 100% 유지  
- **Overlay:** QQQ / IWM / TLT / GLD 소규모 전술적 비중  
- **Gate:** 오버레이는 “작동 가능한 구간”에서만 활성화

---

## 전략 핵심 아이디어 (요약)

본 전략의 핵심 가설은 다음과 같습니다.

> 시장 베타는 지속적이지만,  
> 알파는 국면 의존적이며 항상 존재하지 않는다.

따라서 SPY를 코어로 유지하고,  
**크라우딩이 낮고 최근 알파 성과(IR)가 양수인 경우에만 오버레이를 활성화**합니다.  
리밸런싱은 주간 단위로 제한하여 회전율과 실행 리스크를 통제합니다.

---

## 자산 구성 (Universe)

- **SPY**: 코어 자산 (항상 보유)
- **QQQ**: 성장/테크 성향 (리스크 온)
- **IWM**: 스몰캡 성향 (리스크 온)
- **TLT**: 장기 국채 (리스크 오프)
- **GLD**: 금 (방어/분산)

---

## Core–Overlay 구조

총 비중은 다음과 같이 구성됩니다.
총 비중 = SPY(1.0) + k(t) × Overlay

- `k(t)`는 시간에 따라 변하는 오버레이 스케일
- 조건 미충족 시 `k(t)=0` → SPY 단독 보유

---

## 오버레이 활성화 조건 (중요)

### 1) 크라우딩 필터
- 크라우딩 지표가 임계치(분위수) 이하일 때만 오버레이 허용
- 분산 붕괴 가능성이 높은 구간 회피 목적

### 2) 성과 게이트 (Rolling IR)
- 오버레이의 최근 252일 **Active IR** 계산
- IR ≤ 0 → 오버레이 비활성화
- IR > 0 → 오버레이 허용

이 조건은 “항상 켜진 알파”를 방지하기 위한 장치입니다.

---

## 리밸런싱 규칙
- **주간 리밸런싱** (5 거래일)
- 리밸런싱 사이에는 비중 고정
- 회전율 및 거래비용 통제 목적

---

## 리스크 관리 (실전 기준)

본 프로젝트는 백테스트보다 **실행 안정성**을 우선합니다.

### 비중 제한
- 오버레이 총합 비중 상한
- 전체 포트폴리오 총 노출 상한
- 절대값 기준 계산 (향후 숏 전략 확장 고려)

### 실행 안전장치
- 기본값은 **DRY-RUN (주문 미제출)**
- 주문 제출 시 명시적 `--submit` 필요
- 주문당 최대 금액 제한
- 1회 실행 시 총 회전율 제한
- 일중 중복 실행 방지

---

## 리서치 파라미터 선택 방식

- 대규모 그리드 서치 배제
- **랜덤 서치 + 조기 종료**
- 신호는 사전 계산하여 속도 및 안정성 확보

선정 기준은 다음을 종합적으로 고려합니다.
- Active Return / Alpha
- 베타 안정성 (β ≈ 1)
- 최대 낙폭
- 회전율

---

## 실행 구조 (Paper Trading)

본 저장소는 실제 실행 루프를 포함합니다.

1) 목표 비중 산출
2) 현재 포지션 조회
3) 목표 수량 계산
4) 차이(delta) 기반 주문 생성
5) 리스크 가드 통과 시 주문 제출

Alpaca Paper 계좌에서 다음 항목을 검증했습니다.
- 계좌 연결
- 주문 체결
- 포지션 조회
- 주문 추적

---

## 인터뷰에서 설명할 핵심 포인트

### 왜 이 프로젝트를 만들었나
- 전략 아이디어를 실제 계좌에서 “사고 없이” 실행해보기 위해

### 핵심 차별점
- 백테스트에서 끝나지 않고 실행 레이어까지 구현
- 알파를 항상 쓰지 않고 조건부로 제한

### 실패 가능성
- 국면 분류 오류
- 크라우딩 지표 불안정성
- 거래비용 및 슬리피지

### 향후 개선 방향
- 워크포워드 검증
- 거래비용 모델링
- 리밋 오더 / 실행 알고리즘
- 브로커 추상화 (IBKR, 국내 증권사 API)

---

## 한계 및 주의사항
- 연구용 프로토타입
- 과거 성과는 미래 성과를 보장하지 않음
- 실거래 전 추가 검증 필수
